{% extends "base.html" %}

{% block title %}Order Summary - Rouze Intelligence{% endblock %}

{% block extra_css %}
<style>
    .checkout-container {
        max-width: 900px;
        margin: 0 auto;
    }
    
    .checkout-header {
        text-align: center;
        margin: 60px 0 50px 0;
    }
    
    .checkout-header h1 {
        font-size: 48px;
        margin-bottom: 15px;
        color: #B0A6DF;
    }
    
    .checkout-header .subtitle {
        font-size: 16px;
        color: rgba(176, 166, 223, 0.7);
    }
    
    .order-summary {
        background: rgba(82, 66, 92, 0.04);
        border: 1.5px solid rgba(176, 166, 223, 0.18);
        backdrop-filter: blur(45px);
        padding: 40px;
        border-radius: 20px;
        margin-bottom: 40px;
    }
    
    .summary-section {
        margin-bottom: 30px;
        padding-bottom: 30px;
        border-bottom: 1px solid rgba(176, 166, 223, 0.1);
    }
    
    .summary-section:last-child {
        margin-bottom: 0;
        padding-bottom: 0;
        border-bottom: none;
    }
    
    .section-title {
        font-size: 12px;
        color: #3A8FC3;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 15px;
    }
    
    .tier-name {
        font-size: 24px;
        color: #B0A6DF;
        font-weight: 600;
        margin-bottom: 5px;
    }
    
    .tier-price {
        font-size: 20px;
        color: #3A8FC3;
        font-weight: 700;
        margin-bottom: 15px;
    }
    
    .tier-details {
        font-size: 13px;
        color: rgba(176, 166, 223, 0.85);
        line-height: 1.6;
        margin-bottom: 15px;
    }
    
    .included-items {
        list-style: none;
        margin: 0;
    }
    
    .included-items li {
        font-size: 13px;
        color: rgba(176, 166, 223, 0.85);
        margin-bottom: 8px;
        padding-left: 20px;
        position: relative;
    }
    
    .included-items li:before {
        content: "âœ“";
        position: absolute;
        left: 0;
        color: #3A8FC3;
        font-weight: 700;
    }
    
    .format-upgrades {
        margin-top: 15px;
    }
    
    .upgrade-option {
        margin-bottom: 12px;
        padding: 12px;
        background: rgba(58, 143, 195, 0.05);
        border: 1px solid rgba(58, 143, 195, 0.2);
        border-radius: 8px;
        display: flex;
        align-items: flex-start;
        gap: 12px;
    }
    
    .upgrade-option input[type="checkbox"] {
        width: 16px;
        height: 16px;
        margin-top: 2px;
        cursor: pointer;
        accent-color: #3A8FC3;
        flex-shrink: 0;
    }
    
    .upgrade-info {
        flex: 1;
    }
    
    .upgrade-name {
        font-size: 12px;
        color: #B0A6DF;
        font-weight: 600;
        margin-bottom: 3px;
    }
    
    .upgrade-description {
        font-size: 11px;
        color: rgba(176, 166, 223, 0.6);
    }
    
    .upgrade-price {
        font-size: 14px;
        color: #3A8FC3;
        font-weight: 700;
        flex-shrink: 0;
    }
    
    .pricing-breakdown {
        background: rgba(58, 143, 195, 0.08);
        border: 1px solid rgba(58, 143, 195, 0.2);
        padding: 25px;
        border-radius: 12px;
        margin-bottom: 40px;
    }
    
    .price-line {
        display: flex;
        justify-content: space-between;
        margin-bottom: 12px;
        font-size: 13px;
        color: rgba(176, 166, 223, 0.85);
    }
    
    .price-line.total {
        border-top: 2px solid rgba(58, 143, 195, 0.3);
        padding-top: 12px;
        margin-top: 15px;
        font-size: 20px;
        font-weight: 700;
        color: #3A8FC3;
    }
    
    .price-line.included-note {
        font-size: 11px;
        color: rgba(176, 166, 223, 0.6);
        font-style: italic;
        margin-bottom: 0;
    }
    
    .payment-section {
        background: rgba(82, 66, 92, 0.04);
        border: 1.5px solid rgba(176, 166, 223, 0.18);
        backdrop-filter: blur(45px);
        padding: 40px;
        border-radius: 20px;
        margin-bottom: 40px;
    }
    
    .payment-info {
        font-size: 12px;
        color: rgba(176, 166, 223, 0.7);
        margin-bottom: 20px;
        line-height: 1.6;
    }
    
    .payment-button {
        width: 100%;
        padding: 16px;
        background: rgba(58, 143, 195, 0.2);
        border: 1.5px solid rgba(58, 143, 195, 0.5);
        color: #3A8FC3;
        border-radius: 50px;
        font-weight: 700;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .payment-button:hover {
        background: rgba(58, 143, 195, 0.3);
        border: 1.5px solid rgba(58, 143, 195, 0.7);
    }
    
    .nav-buttons {
        display: flex;
        gap: 20px;
        margin-top: 30px;
    }
    
    .btn-back {
        padding: 12px 30px;
        background: transparent;
        border: 1.5px solid rgba(176, 166, 223, 0.3);
        color: #B0A6DF;
        border-radius: 50px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .btn-back:hover {
        border: 1.5px solid rgba(176, 166, 223, 0.6);
        background: rgba(176, 166, 223, 0.05);
    }
</style>
{% endblock %}

{% block content %}
<div class="checkout-container">
    <div class="checkout-header">
        <h1>Order Summary</h1>
        <p class="subtitle">Review your analysis package</p>
    </div>
    
    <div class="order-summary">
        <!-- TIER DETAILS -->
        <div class="summary-section">
            <div class="section-title">Analysis Tier</div>
            
            {% if tier == 'quick' %}
                <div class="tier-name">Quick Intelligence</div>
                <div class="tier-price">$300</div>
                <div class="tier-details">24-48 hour analysis with 10,000+ signals from 5-7 sources</div>
            {% elif tier == 'strategic' %}
                <div class="tier-name">Strategic Intelligence</div>
                <div class="tier-price">$800</div>
                <div class="tier-details">5-7 day analysis with 25,000+ signals from 8-12 sources</div>
            {% elif tier == 'predictive' %}
                <div class="tier-name">Predictive Intelligence</div>
                <div class="tier-price">$2,000</div>
                <div class="tier-details">10-14 day analysis with 50,000+ signals and 12-24 month forecasting</div>
            {% elif tier == 'enterprise' %}
                <div class="tier-name">Enterprise Partnership</div>
                <div class="tier-price">Custom</div>
                <div class="tier-details">Ongoing intelligence with daily monitoring and dedicated analyst</div>
            {% endif %}
            
            <ul class="included-items">
                <li>Executive summary with key insights</li>
                <li>HTML interactive dashboard (90-day access)</li>
                <li>PDF executive brief (downloadable)</li>
                <li>Interactive charts and visualizations</li>
                <li>Raw signals library (searchable, filterable)</li>
                <li>Export capabilities (PDF, PNG, CSV)</li>
            </ul>
        </div>
        
        <!-- FORMAT UPGRADES -->
        <div class="summary-section">
            <div class="section-title">Optional Upgrades</div>
            
            <div class="format-upgrades">
                <div class="upgrade-option">
                    <input type="checkbox" id="dashboard-upgrade" name="dashboard" onchange="updatePrice()">
                    <div class="upgrade-info">
                        <div class="upgrade-name">Interactive Dashboard</div>
                        <div class="upgrade-description">12-month access, daily updates, custom alerts, team collaboration (5 users)</div>
                    </div>
                    <div class="upgrade-price">+$200</div>
                </div>
                
                <div class="upgrade-option">
                    <input type="checkbox" id="api-upgrade" name="api" onchange="updatePrice()">
                    <div class="upgrade-info">
                        <div class="upgrade-name">API Integration</div>
                        <div class="upgrade-description">JSON API, real-time feeds, webhooks, historical data export, developer docs</div>
                    </div>
                    <div class="upgrade-price">+$500</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- PRICING BREAKDOWN -->
    <div class="pricing-breakdown">
        <div class="price-line">
            <span id="tier-label">Base Tier</span>
            <span id="base-price">$300</span>
        </div>
        <div class="price-line" id="dashboard-line" style="display: none;">
            <span>Interactive Dashboard Upgrade</span>
            <span>+$200</span>
        </div>
        <div class="price-line" id="api-line" style="display: none;">
            <span>API Integration Upgrade</span>
            <span>+$500</span>
        </div>
        <div class="price-line total">
            <span>Total</span>
            <span id="total-price">$300</span>
        </div>
    </div>
    
    <!-- PAYMENT SECTION -->
    <div class="payment-section">
        <div class="payment-info">
            By proceeding to payment, you agree to our Terms of Service and understand that analysis will begin upon payment confirmation. You'll receive your results within the promised timeframe to your dashboard and email.
        </div>
        <button class="payment-button" onclick="proceedToPayment()">Proceed to Secure Checkout</button>
    </div>
    
    <!-- NAVIGATION -->
    <div class="nav-buttons">
        <button class="btn-back" onclick="goBack()">Back to Tier Selection</button>
    </div>
</div>

<script>
// Define tier pricing (STARTING PRICE)
const tierPrices = {
    'quick': { price: 300, name: 'Quick Intelligence' },
    'strategic': { price: 800, name: 'Strategic Intelligence' },
    'predictive': { price: 2000, name: 'Predictive Intelligence' },
    'enterprise': { price: null, name: 'Enterprise Partnership' }
};

const tier = '{{ tier }}';
const basePrice = tierPrices[tier];

function updatePrice() {
    const dashboard = document.getElementById('dashboard-upgrade').checked;
    const api = document.getElementById('api-upgrade').checked;
    
    // Show/hide upgrade lines
    document.getElementById('dashboard-line').style.display = dashboard ? 'flex' : 'none';
    document.getElementById('api-line').style.display = api ? 'flex' : 'none';
    
    // Calculate total
    if (tier === 'enterprise') {
        document.getElementById('total-price').textContent = 'Contact for quote';
    } else {
        let total = basePrice.price;
        
        if (dashboard) {
            total += 200;
        }
        if (api) {
            total += 500;
        }
        
        document.getElementById('total-price').textContent = '$' + total.toLocaleString();
    }
}

function proceedToPayment() {
    const vertical = '{{ vertical }}';
    const tier = '{{ tier }}';
    const dashboard = document.getElementById('dashboard-upgrade').checked ? 'yes' : 'no';
    const api = document.getElementById('api-upgrade').checked ? 'yes' : 'no';
    
    alert('Payment integration coming soon.\n\nSelected:\n- Vertical: ' + vertical + '\n- Tier: ' + tier + '\n- Dashboard: ' + dashboard + '\n- API: ' + api);
}

function goBack() {
    const vertical = '{{ vertical }}';
    window.location.href = '/tier-selection/' + vertical;
}

// Initialize on page load
window.addEventListener('load', () => {
    // Set tier label
    document.getElementById('tier-label').textContent = 'Base Tier (' + basePrice.name + ')';
    
    // Initialize pricing
    updatePrice();
});
</script>
{% endblock %}
