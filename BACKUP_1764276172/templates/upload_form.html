{% extends "base.html" %}

{% block title %}Upload Data - Rouze Intelligence{% endblock %}

{% block extra_css %}
<style>
    .upload-container {
        max-width: 700px;
        margin: 0 auto;
    }
    
    .upload-header {
        text-align: center;
        margin: 60px 0 50px 0;
    }
    
    .upload-header h1 {
        font-size: 44px;
        margin-bottom: 15px;
        color: #B0A6DF;
    }
    
    .upload-header .subtitle {
        font-size: 16px;
        color: rgba(176, 166, 223, 0.7);
        margin-bottom: 10px;
    }
    
    .upload-header .note {
        font-size: 12px;
        color: rgba(176, 166, 223, 0.6);
        font-style: italic;
    }
    
    .upload-form {
        background: rgba(82, 66, 92, 0.04);
        border: 1.5px solid rgba(176, 166, 223, 0.18);
        backdrop-filter: blur(45px);
        padding: 40px;
        border-radius: 20px;
        margin-bottom: 40px;
    }
    
    .form-section {
        margin-bottom: 30px;
    }
    
    .section-title {
        font-size: 12px;
        color: #3A8FC3;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 20px;
    }
    
    .upload-option {
        margin-bottom: 20px;
    }
    
    .upload-label {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 10px;
        cursor: pointer;
    }
    
    .upload-label input[type="checkbox"] {
        width: 18px;
        height: 18px;
        cursor: pointer;
        accent-color: #3A8FC3;
        flex-shrink: 0;
    }
    
    .upload-label-text {
        font-size: 14px;
        color: #B0A6DF;
        font-weight: 500;
    }
    
    .file-input-wrapper {
        display: none;
        margin-top: 10px;
        padding: 15px;
        background: rgba(58, 143, 195, 0.05);
        border: 1px solid rgba(58, 143, 195, 0.2);
        border-radius: 8px;
    }
    
    .file-input-wrapper.active {
        display: block;
    }
    
    .file-input-label {
        display: block;
        padding: 10px 16px;
        background: rgba(58, 143, 195, 0.1);
        border: 1px dashed rgba(58, 143, 195, 0.5);
        border-radius: 8px;
        color: #3A8FC3;
        cursor: pointer;
        font-size: 12px;
        transition: all 0.3s ease;
        text-align: center;
    }
    
    .file-input-label:hover {
        background: rgba(58, 143, 195, 0.15);
        border: 1px dashed rgba(58, 143, 195, 0.7);
    }
    
    .file-input {
        display: none;
    }
    
    .file-name {
        font-size: 11px;
        color: rgba(176, 166, 223, 0.6);
        margin-top: 8px;
    }
    
    .security-section {
        background: rgba(58, 143, 195, 0.08);
        border: 1px solid rgba(58, 143, 195, 0.2);
        padding: 20px;
        border-radius: 12px;
        margin-bottom: 30px;
    }
    
    .security-title {
        font-size: 13px;
        color: #B0A6DF;
        font-weight: 600;
        margin-bottom: 10px;
    }
    
    .security-badges {
        display: flex;
        gap: 12px;
        margin-bottom: 15px;
        flex-wrap: wrap;
    }
    
    .badge {
        font-size: 11px;
        color: #3A8FC3;
        background: rgba(58, 143, 195, 0.1);
        padding: 6px 12px;
        border-radius: 50px;
        border: 1px solid rgba(58, 143, 195, 0.3);
    }
    
    .security-details {
        font-size: 12px;
        color: rgba(176, 166, 223, 0.7);
        line-height: 1.6;
    }
    
    .security-details strong {
        color: #B0A6DF;
    }
    
    .deletion-policy {
        margin-top: 15px;
        padding-top: 15px;
        border-top: 1px solid rgba(58, 143, 195, 0.2);
    }
    
    .policy-label {
        font-size: 12px;
        color: #B0A6DF;
        font-weight: 600;
        margin-bottom: 10px;
        display: block;
    }
    
    .policy-option {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 8px;
        font-size: 12px;
        color: rgba(176, 166, 223, 0.8);
    }
    
    .policy-option input[type="radio"] {
        accent-color: #3A8FC3;
    }
    
    .form-actions {
        display: flex;
        gap: 15px;
        margin-top: 40px;
    }
    
    .btn-skip {
        flex: 1;
        padding: 14px;
        background: transparent;
        border: 1.5px solid rgba(176, 166, 223, 0.3);
        color: #B0A6DF;
        border-radius: 50px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .btn-skip:hover {
        border: 1.5px solid rgba(176, 166, 223, 0.6);
        background: rgba(176, 166, 223, 0.05);
    }
    
    .btn-upload {
        flex: 1;
        padding: 14px;
        background: rgba(58, 143, 195, 0.2);
        border: 1.5px solid rgba(58, 143, 195, 0.5);
        color: #3A8FC3;
        border-radius: 50px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .btn-upload:hover {
        background: rgba(58, 143, 195, 0.3);
        border: 1.5px solid rgba(58, 143, 195, 0.7);
    }
</style>
{% endblock %}

{% block content %}
<div class="upload-container">
    <div class="upload-header">
        <h1>Enhance Your Analysis</h1>
        <p class="subtitle">Upload your business data for more targeted insights</p>
        <p class="note">(Optional - your data never leaves your secure vault)</p>
    </div>
    
    <form class="upload-form" method="POST" action="/api/upload" enctype="multipart/form-data">
        <input type="hidden" name="vertical" value="{{ vertical }}">
        
        <!-- UPLOAD SECTIONS -->
        <div class="form-section">
            <div class="section-title">Available Data Types</div>
            
            <!-- Financial Data -->
            <div class="upload-option">
                <label class="upload-label">
                    <input type="checkbox" name="upload_financial" onchange="toggleFileInput('financial')">
                    <span class="upload-label-text">Financial Data</span>
                </label>
                <div id="financial-wrapper" class="file-input-wrapper">
                    <label class="file-input-label" for="financial-file">
                        Click to upload or drag and drop (CSV or PDF)
                    </label>
                    <input type="file" id="financial-file" name="financial_file" class="file-input" accept=".csv,.pdf">
                    <div class="file-name" id="financial-name"></div>
                </div>
            </div>
            
            <!-- Customer Feedback -->
            <div class="upload-option">
                <label class="upload-label">
                    <input type="checkbox" name="upload_feedback" onchange="toggleFileInput('feedback')">
                    <span class="upload-label-text">Customer Feedback Database</span>
                </label>
                <div id="feedback-wrapper" class="file-input-wrapper">
                    <label class="file-input-label" for="feedback-file">
                        Click to upload or drag and drop (TXT or CSV)
                    </label>
                    <input type="file" id="feedback-file" name="feedback_file" class="file-input" accept=".csv,.txt">
                    <div class="file-name" id="feedback-name"></div>
                </div>
            </div>
            
            <!-- Competitive Research -->
            <div class="upload-option">
                <label class="upload-label">
                    <input type="checkbox" name="upload_competitive" onchange="toggleFileInput('competitive')">
                    <span class="upload-label-text">Competitive Research</span>
                </label>
                <div id="competitive-wrapper" class="file-input-wrapper">
                    <label class="file-input-label" for="competitive-file">
                        Click to upload or drag and drop (PDF or TXT)
                    </label>
                    <input type="file" id="competitive-file" name="competitive_file" class="file-input" accept=".pdf,.txt">
                    <div class="file-name" id="competitive-name"></div>
                </div>
            </div>
        </div>
        
        <!-- SECURITY SECTION -->
        <div class="security-section">
            <div class="security-title">Your Data is Secure</div>
            
            <div class="security-badges">
                <span class="badge">✓ TLS 1.3 Encryption</span>
                <span class="badge">✓ SOC 2 Certified</span>
                <span class="badge">✓ Auto-deleted</span>
            </div>
            
            <div class="security-details">
                <p>Your data is encrypted during transmission and at rest using bank-grade security. We never share your data with third parties or use it for other clients' analyses.</p>
            </div>
            
            <div class="deletion-policy">
                <label class="policy-label">Data Deletion Policy</label>
                <div class="policy-option">
                    <input type="radio" id="delete-immediate" name="deletion_policy" value="immediate" checked>
                    <label for="delete-immediate">Delete immediately after analysis</label>
                </div>
                <div class="policy-option">
                    <input type="radio" id="delete-30days" name="deletion_policy" value="30days">
                    <label for="delete-30days">Keep for 30 days, then auto-delete</label>
                </div>
                <div class="policy-option">
                    <input type="radio" id="delete-manual" name="deletion_policy" value="manual">
                    <label for="delete-manual">Request manual deletion anytime</label>
                </div>
            </div>
        </div>
        
        <!-- FORM ACTIONS -->
        <div class="form-actions">
            <button type="button" class="btn-skip" onclick="skipUpload()">Skip Upload, Continue</button>
            <button type="submit" class="btn-upload">Upload Files & Continue</button>
        </div>
    </form>
</div>

<script>
function toggleFileInput(type) {
    const wrapper = document.getElementById(type + '-wrapper');
    wrapper.classList.toggle('active');
}

function skipUpload() {
    const vertical = '{{ vertical }}';
    window.location.href = '/tier-selection/' + vertical;
}

// File name display on select
document.getElementById('financial-file')?.addEventListener('change', (e) => {
    document.getElementById('financial-name').textContent = e.target.files[0]?.name || '';
});
document.getElementById('feedback-file')?.addEventListener('change', (e) => {
    document.getElementById('feedback-name').textContent = e.target.files[0]?.name || '';
});
document.getElementById('competitive-file')?.addEventListener('change', (e) => {
    document.getElementById('competitive-name').textContent = e.target.files[0]?.name || '';
});

// Form submission
document.querySelector('.upload-form')?.addEventListener('submit', function(e) {
    e.preventDefault();
    const vertical = '{{ vertical }}';
    window.location.href = '/tier-selection/' + vertical;
});
</script>
{% endblock %}
